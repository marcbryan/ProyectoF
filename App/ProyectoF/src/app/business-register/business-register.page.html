<ngx-loading-bar color="#1a73e8"></ngx-loading-bar>
<mat-horizontal-stepper class="dark-theme" linear #stepper>
    <mat-step [stepControl]="businessForm">
      <form [formGroup]="businessForm">
        <ng-template matStepLabel>Registra tu negocio</ng-template>
        <mat-form-field appearance="fill">
          <mat-label>Nombre</mat-label>
          <input matInput formControlName="name" required>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Dirección</mat-label>
          <input matInput formControlName="address" required>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Ciudad</mat-label>
          <input matInput formControlName="city" required>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Código postal</mat-label>
          <input numeric matInput formControlName="zipcode" #zipcode maxlength="5" required>
          <mat-error *ngIf="zipcode.invalid">{{getZipcodeErrorMessage()}}</mat-error>
          <mat-hint align="end">{{zipcode.value?.length || 0}}/5</mat-hint>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Teléfono del negocio</mat-label>
          <input numeric matInput formControlName="phone" #phone maxlength="9" required>
          <mat-error *ngIf="phone.invalid">{{getPhoneErrorMessage()}}</mat-error>
          <mat-hint align="end">{{phone.value?.length || 0}}/9</mat-hint>
        </mat-form-field>
        <div class="button">
          <button mat-button matStepperNext>Siguiente</button>
        </div>
      </form>
    </mat-step>
    <mat-step [stepControl]="userForm">
      <form [formGroup]="userForm">
        <ng-template matStepLabel>Crea una cuenta</ng-template>
        <mat-form-field appearance="fill">
          <mat-label>Nombre</mat-label>
          <input matInput formControlName="name" required>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Apellidos</mat-label>
          <input matInput formControlName="last_name" required>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Correo electrónico</mat-label>
          <input type="email" matInput formControlName="email" required [email]="true">
          <mat-error *ngIf="userForm.get('email').invalid">{{getEmailErrorMessage()}}</mat-error>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Contraseña</mat-label>
          <input type="password" matInput formControlName="password" required>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Repite tu contraseña</mat-label>
          <input type="password" matInput formControlName="confirmPassword" required>
        </mat-form-field>
        <mat-form-field appearance="fill">
          <mat-label>Número de móvil</mat-label>
          <input numeric matInput formControlName="phone" #phone2 maxlength="9" required>
          <mat-error *ngIf="phone2.invalid">{{getPhone2ErrorMessage()}}</mat-error>
          <mat-hint align="end">{{phone2.value?.length || 0}}/9</mat-hint>
        </mat-form-field>
        <div class="buttons">
          <button mat-button matStepperPrevious>Atrás</button>
          <button mat-button matStepperNext>Siguiente</button>
        </div>
      </form>
    </mat-step>
    <mat-step>
      <ng-template matStepLabel>Listo</ng-template>
      <p>Ya has terminado, comprueba que todos los datos son correctos.</p>
      <p>Si quieres editar algún dato vuelve atrás.</p>
      <div>
        <button mat-button matStepperPrevious>Atrás</button>
        <button mat-button color="warn" (click)="stepper.reset()">Volver a empezar</button>
        <button mat-button style="color: #1a73e8" (click)="register()">Confirmar y crear</button>
      </div>
    </mat-step>
  </mat-horizontal-stepper>